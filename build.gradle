
/*
plugins {
    // Apply the java plugin to add support for Java
    id 'java'

    // Apply the application plugin to add support for building a CLI application
    id 'application'
}

repositories {
    // Use jcenter for resolving dependencies.
    // You can declare any Maven/Ivy/file repository here.
    jcenter()
}

dependencies {

    // Use TestNG framework, also requires calling test.useTestNG() below
    testImplementation 'org.testng:testng:6.14.3'
}

application {
    // Define the main class for the application
    mainClassName = 'org.avphs.App'
}

test {
    // Use TestNG for unit tests
    useTestNG()
}
*/

plugins {
    id 'com.gradle.build-scan' version '2.3'
}

subprojects {
    tasks.withType(Jar) {
        destinationDir = file("$rootDir/mods")
    }
    afterEvaluate { Project project ->
        repositories {
            jcenter()
        }

        targetCompatibility = '12'

        if (project.hasProperty("moduleName")) {
            compileJava {
                destinationDir = project.file("build/mods")
                options.compilerArgs = [
                    '--module-path', classpath.asPath,
                    '--module-source-path', sourceSets.main.java.srcDirs.join(System.getProperty('path.separator')),
                    '-m', moduleName,
                ]
                doLast {
                    copy {
                        from file(new File(destinationDir,  moduleName))
                        into sourceSets.main.java.outputDir.absolutePath
                    }
                }
            }
        }
    }
}

buildScan {
    termsOfServiceUrl = 'https://gradle.com/terms-of-service'
    termsOfServiceAgree = 'yes'
}